<!DOCTYPE html>
<html>
<head>
  <title>Spletne</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/sammy.js/0.7.4/sammy.min.js"></script>
  <script type="text/javascript" charset="utf-8">
      ; (function ($) {         

          var app = $.sammy(function () {

              this.get('#/', function () {
                  $('#main').text('');
                  ctx.app.swap('');
              });

              this.get('#/test', function () {
                  $('#main').text('Hello World');
              });
              this.get('#/dogodki', function (ctx) {
                  $('#main').text('Dogodki');
                  ctx.app.swap('');
                  ctx.$element().append('<h1>dogodki</h1>');
                  var Dogodek = persistence.define('Dogodek', { 
                    id: "int"
                    cas: "dateTime", 
                    koordinate: "TEXT",
                    uporabnik_id: "int"
                  }); 
                  var Priljubljene = persistence.define('Dogodek', { 
                    id: "int"
                    oznaka: "TEXT", 
                    koordinate: "TEXT",
                    uporabnik_id: "int"
                  }); 
                  //ctx.$element().append('<li><a href="#/">Nazaj</a></li>');
                   //ctx.$element().append('<h1>' + this.params['id'] + '</h1>');
                  
                /*$.ajax({
     type: "GET",
     url: "http://localhost:3000/dogodki/",
     async: false,
     beforeSend: function(x) {
      if(x &amp;&amp; x.overrideMimeType) {
       x.overrideMimeType("application/j-son;charset=UTF-8");
      }
 },
 dataType: "json",
 success: function(data){
    $.each(data, function(i, field){
                          $("#main").append(field + " ");
                            //ctx.$element().append(result, function(i, field);
                        });
 }
});*/
              });
              this.get('#/dogodki/:id', function(context) {
                  $('#main').text(this.params['id']); 
                  //ctx.app.swap('');
                  //ctx.$element().append('<h1>' + this.params['id'] + '</h1>');
                  /*$(document).ready(function(){
                    
                      $.getJSON("http://localhost:3000/dogodki/", function(result){
                        $.each(result, function(i, field){
                          //$("div").append(field + " ");
                            ctx.$element().append(result, function(i, field);
                        });
                      });
                  });
                  */
                  window.sessionStorage.setItem('name', "ja");
                  alert(window.sessionStorage.getItem('name'));
                  $(document).ready(function(){
                    $.getJSON("http://localhost:3000/dogodki/", function(result){
                      
                      $('#main').text(result); 
                    });
                  //$('#main').appendtext(this.params['id']); 
                  });
              });
        

              this.get('#/dogodki_dodaj', function(context) {
                  context.app.swap('');
                  context.$element().append('<a>Cas?</a> <br>'
                  + '<a>koordinate?</a> <br>'
                  + '<a>User ID?</a> <br>'
                  + '<form action="#/dogodki_dodaj" method="post">'
                  + '<input type="text" name="cas" /> <br>'                  
                  + '<input type="text" name="koo" /> <br>'                  
                  + '<input type="text" name="uid" /><br>'
                  + '<input type="submit" name="submit" />'
                  + '</form>'); 
              });
              this.post('#/dogodki_dodaj', function(context) {
                context.app.swap('');
                var to = this.params['cas'];
                var to2 = this.params['koo'];
                var to3 = this.params['uid'];
                context.$element().append('<h1>cas: ' + to + '</h1><br>');
                context.$element().append('<h1>koordinate: ' + to2 + '</h1><br>');
                context.$element().append('<h1>UID: ' + to3 + '</h1><br>');
                var j={"cas":to,"koo":to2,"uid":to3};
                //JSON.stringify(j);
                context.$element().append(JSON.stringify(j));
              });
          });
          $(function () {
              app.run()
          });
      })(jQuery);
  </script>
</head>
<body>
    <div id="main"></div>
    <ul id="link">
      <li><a href="#/dogodki">Dogodki</a></li>
      <li><a href="#/dogodki_dodaj">Dogodki dodaj</a></li>      
    </ul>
</body>
</html>